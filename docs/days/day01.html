<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Day 1 â€“ What â€˜goodâ€™ Data Is â€“ Digital Competence in the Biological Sciences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/images/course-logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Digital Competence in the Biological Sciences</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../days/day01.html">Course Days</a></li><li class="breadcrumb-item"><a href="../days/day01.html">Day 1 â€“ What â€˜goodâ€™ Data Is</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Digital Competence in the Biological Sciences</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Days</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../days/day01.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Day 1 â€“ What â€˜goodâ€™ Data Is</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../days/day02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 2 â€“ Describing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../days/day03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 3 â€“ From repetition to algorithms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../days/day04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 4 â€“ Cleaning data and making work reproducible</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../days/day05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 5 â€“ Tools, models, and scientific responsibility</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#agenda" id="toc-agenda" class="nav-link" data-scroll-target="#agenda">Agenda</a></li>
  <li><a href="#context-a-real-world-case-study" id="toc-context-a-real-world-case-study" class="nav-link" data-scroll-target="#context-a-real-world-case-study">Context: a real-world case study</a></li>
  <li><a href="#what-is-data" id="toc-what-is-data" class="nav-link" data-scroll-target="#what-is-data">What is data?</a></li>
  <li><a href="#core-comcepts-definition" id="toc-core-comcepts-definition" class="nav-link" data-scroll-target="#core-comcepts-definition">Core comcepts definition</a></li>
  <li><a href="#what-counts-as-data-in-biology" id="toc-what-counts-as-data-in-biology" class="nav-link" data-scroll-target="#what-counts-as-data-in-biology">What counts as data in biology?</a></li>
  <li><a href="#why-context-matters-metadata" id="toc-why-context-matters-metadata" class="nav-link" data-scroll-target="#why-context-matters-metadata">Why context matters: metadata</a>
  <ul class="collapse">
  <li><a href="#example-there-is-data-and-there-is-data" id="toc-example-there-is-data-and-there-is-data" class="nav-link" data-scroll-target="#example-there-is-data-and-there-is-data">Example: There is data, and there is data</a></li>
  <li><a href="#where-metadata-should-live-best-practice" id="toc-where-metadata-should-live-best-practice" class="nav-link" data-scroll-target="#where-metadata-should-live-best-practice">Where metadata should live (best practice)</a></li>
  </ul></li>
  <li><a href="#the-fair-principles-what-they-really-mean" id="toc-the-fair-principles-what-they-really-mean" class="nav-link" data-scroll-target="#the-fair-principles-what-they-really-mean">The FAIR principles (what they really mean)</a>
  <ul class="collapse">
  <li><a href="#findable" id="toc-findable" class="nav-link" data-scroll-target="#findable">ğŸ” Findable</a></li>
  <li><a href="#accessible" id="toc-accessible" class="nav-link" data-scroll-target="#accessible">ğŸ”“ Accessible</a></li>
  <li><a href="#interoperable" id="toc-interoperable" class="nav-link" data-scroll-target="#interoperable">ğŸ”— Interoperable</a></li>
  <li><a href="#reusable" id="toc-reusable" class="nav-link" data-scroll-target="#reusable">â™»ï¸ Reusable</a></li>
  </ul></li>
  <li><a href="#data-are-not-neutral" id="toc-data-are-not-neutral" class="nav-link" data-scroll-target="#data-are-not-neutral">Data are not neutral</a></li>
  <li><a href="#why-this-matters-for-tools-like-excel-and-r" id="toc-why-this-matters-for-tools-like-excel-and-r" class="nav-link" data-scroll-target="#why-this-matters-for-tools-like-excel-and-r">Why this matters for tools like Excel and R</a></li>
  <li><a href="#data-as-a-model" id="toc-data-as-a-model" class="nav-link" data-scroll-target="#data-as-a-model">Data as a model</a></li>
  <li><a href="#the-data-lifecycle" id="toc-the-data-lifecycle" class="nav-link" data-scroll-target="#the-data-lifecycle">The Data lifecycle</a></li>
  <li><a href="#spreadsheet-failures-lead-to-financial-policy-and-health-costs" id="toc-spreadsheet-failures-lead-to-financial-policy-and-health-costs" class="nav-link" data-scroll-target="#spreadsheet-failures-lead-to-financial-policy-and-health-costs">Spreadsheet Failures lead to Financial, Policy, and Health Costs</a>
  <ul class="collapse">
  <li><a href="#why-excel-behaves-the-way-it-does" id="toc-why-excel-behaves-the-way-it-does" class="nav-link" data-scroll-target="#why-excel-behaves-the-way-it-does">Why Excel behaves the way it does</a></li>
  <li><a href="#mi5-wiretapped-the-wrong-people" id="toc-mi5-wiretapped-the-wrong-people" class="nav-link" data-scroll-target="#mi5-wiretapped-the-wrong-people">ğŸ•µï¸ğŸ“ğŸ¯âŒ MI5 wiretapped the wrong people</a></li>
  <li><a href="#nearly-16000-covid-19-cases-lost-in-england" id="toc-nearly-16000-covid-19-cases-lost-in-england" class="nav-link" data-scroll-target="#nearly-16000-covid-19-cases-lost-in-england">ğŸ¦ ğŸ“‰ğŸš«ğŸ“‹ Nearly 16,000 COVID-19 cases lost in England</a></li>
  <li><a href="#reinhart-rogoff-economic-growth-error" id="toc-reinhart-rogoff-economic-growth-error" class="nav-link" data-scroll-target="#reinhart-rogoff-economic-growth-error">ğŸ“Šâ—âš ï¸ğŸ›ï¸ Reinhart &amp; Rogoff economic growth error</a></li>
  <li><a href="#fannie-mae-misreported-over-1-billion" id="toc-fannie-mae-misreported-over-1-billion" class="nav-link" data-scroll-target="#fannie-mae-misreported-over-1-billion">ğŸ’°ğŸ“‘âŒğŸ¦ Fannie Mae misreported over $1 billion</a></li>
  <li><a href="#jpmorgan-london-whale-6-billion-loss" id="toc-jpmorgan-london-whale-6-billion-loss" class="nav-link" data-scroll-target="#jpmorgan-london-whale-6-billion-loss">ğŸ‹ğŸ“‰ğŸ’£ğŸ¦ JPMorgan â€œLondon Whaleâ€ $6 billion loss</a></li>
  </ul></li>
  <li><a href="#spreadsheet-failures-in-biology-and-environmental-sciences" id="toc-spreadsheet-failures-in-biology-and-environmental-sciences" class="nav-link" data-scroll-target="#spreadsheet-failures-in-biology-and-environmental-sciences">Spreadsheet Failures in Biology and Environmental Sciences</a>
  <ul class="collapse">
  <li><a href="#gene-name-auto-conversion-errors-in-genomics" id="toc-gene-name-auto-conversion-errors-in-genomics" class="nav-link" data-scroll-target="#gene-name-auto-conversion-errors-in-genomics">ğŸ§¬ğŸ“…âŒğŸ“Š Gene name auto-conversion errors in genomics</a></li>
  </ul></li>
  <li><a href="#what-all-these-failures-have-in-common" id="toc-what-all-these-failures-have-in-common" class="nav-link" data-scroll-target="#what-all-these-failures-have-in-common">What all these failures have in common</a>
  <ul class="collapse">
  <li><a href="#concept-that-would-have-prevented-this" id="toc-concept-that-would-have-prevented-this" class="nav-link" data-scroll-target="#concept-that-would-have-prevented-this">Concept that would have prevented this</a></li>
  <li><a href="#core-data-concepts-reinforced-by-these-cases" id="toc-core-data-concepts-reinforced-by-these-cases" class="nav-link" data-scroll-target="#core-data-concepts-reinforced-by-these-cases">Core data concepts reinforced by these cases</a></li>
  </ul></li>
  <li><a href="#excel-as-a-data-tool" id="toc-excel-as-a-data-tool" class="nav-link" data-scroll-target="#excel-as-a-data-tool">Excel as a data tool</a></li>
  <li><a href="#file-formats-metadata-and-storage" id="toc-file-formats-metadata-and-storage" class="nav-link" data-scroll-target="#file-formats-metadata-and-storage">File formats, metadata, and storage</a>
  <ul class="collapse">
  <li><a href="#common-excel-related-file-formats" id="toc-common-excel-related-file-formats" class="nav-link" data-scroll-target="#common-excel-related-file-formats">Common Excel-related file formats</a></li>
  <li><a href="#separators-delimiters-commas-tabs-semicolons-and-why-they-matter" id="toc-separators-delimiters-commas-tabs-semicolons-and-why-they-matter" class="nav-link" data-scroll-target="#separators-delimiters-commas-tabs-semicolons-and-why-they-matter">Separators (delimiters): commas, tabs, semicolons, and why they matter</a></li>
  <li><a href="#common-separators-you-will-encounter" id="toc-common-separators-you-will-encounter" class="nav-link" data-scroll-target="#common-separators-you-will-encounter">Common separators you will encounter</a></li>
  <li><a href="#why-separators-break-things" id="toc-why-separators-break-things" class="nav-link" data-scroll-target="#why-separators-break-things">Why separators break things</a></li>
  <li><a href="#csv-is-not-a-standard-this-surprises-many-people" id="toc-csv-is-not-a-standard-this-surprises-many-people" class="nav-link" data-scroll-target="#csv-is-not-a-standard-this-surprises-many-people">CSV is not a standard (this surprises many people)</a></li>
  <li><a href="#tsv-is-often-safer-than-csv" id="toc-tsv-is-often-safer-than-csv" class="nav-link" data-scroll-target="#tsv-is-often-safer-than-csv">TSV is often safer than CSV</a></li>
  <li><a href="#how-excel-decides-which-separator-to-use" id="toc-how-excel-decides-which-separator-to-use" class="nav-link" data-scroll-target="#how-excel-decides-which-separator-to-use">How Excel decides which separator to use</a></li>
  <li><a href="#text-encodings" id="toc-text-encodings" class="nav-link" data-scroll-target="#text-encodings">Text encodings</a></li>
  </ul></li>
  <li><a href="#encodings-are-invisible-until-they-break." id="toc-encodings-are-invisible-until-they-break." class="nav-link" data-scroll-target="#encodings-are-invisible-until-they-break.">Encodings are invisible until they break.</a></li>
  <li><a href="#hands-on-session-structured-data-entry" id="toc-hands-on-session-structured-data-entry" class="nav-link" data-scroll-target="#hands-on-session-structured-data-entry">Hands-on session: structured data entry</a>
  <ul class="collapse">
  <li><a href="#training-datasets-and-templates" id="toc-training-datasets-and-templates" class="nav-link" data-scroll-target="#training-datasets-and-templates">Training datasets and templates</a></li>
  </ul></li>
  <li><a href="#importing-csv-tsv-and-delimited-text-correctly" id="toc-importing-csv-tsv-and-delimited-text-correctly" class="nav-link" data-scroll-target="#importing-csv-tsv-and-delimited-text-correctly">Importing CSV, TSV, and delimited text correctly</a>
  <ul class="collapse">
  <li><a href="#correct-import-workflow-excel-365" id="toc-correct-import-workflow-excel-365" class="nav-link" data-scroll-target="#correct-import-workflow-excel-365">Correct import workflow (Excel 365)</a></li>
  </ul></li>
  <li><a href="#common-data-formats-inside-excel-and-how-to-use-them" id="toc-common-data-formats-inside-excel-and-how-to-use-them" class="nav-link" data-scroll-target="#common-data-formats-inside-excel-and-how-to-use-them">Common data formats inside Excel (and how to use them)</a></li>
  <li><a href="#defining-data-formats-explicitly-minimum-discipline" id="toc-defining-data-formats-explicitly-minimum-discipline" class="nav-link" data-scroll-target="#defining-data-formats-explicitly-minimum-discipline">Defining data formats explicitly (minimum discipline)</a></li>
  <li><a href="#using-formatting-to-understand-data-not-decorate-it" id="toc-using-formatting-to-understand-data-not-decorate-it" class="nav-link" data-scroll-target="#using-formatting-to-understand-data-not-decorate-it">Using formatting to understand data (not decorate it)</a>
  <ul class="collapse">
  <li><a href="#minimal-but-effective-practices" id="toc-minimal-but-effective-practices" class="nav-link" data-scroll-target="#minimal-but-effective-practices">Minimal but effective practices</a></li>
  </ul></li>
  <li><a href="#limiting-data-entry-to-avoid-mistakes" id="toc-limiting-data-entry-to-avoid-mistakes" class="nav-link" data-scroll-target="#limiting-data-entry-to-avoid-mistakes">Limiting data entry (to avoid mistakes)</a>
  <ul class="collapse">
  <li><a href="#data-validation-essential" id="toc-data-validation-essential" class="nav-link" data-scroll-target="#data-validation-essential">Data validation (essential)</a></li>
  <li><a href="#creating-drop-down-lists-controlled-vocabularies" id="toc-creating-drop-down-lists-controlled-vocabularies" class="nav-link" data-scroll-target="#creating-drop-down-lists-controlled-vocabularies">Creating drop-down lists (controlled vocabularies)</a></li>
  </ul></li>
  <li><a href="#avoiding-copy-paste-disasters" id="toc-avoiding-copy-paste-disasters" class="nav-link" data-scroll-target="#avoiding-copy-paste-disasters">Avoiding copy-paste disasters</a></li>
  <li><a href="#sorting-and-ranking-data-safely" id="toc-sorting-and-ranking-data-safely" class="nav-link" data-scroll-target="#sorting-and-ranking-data-safely">Sorting and ranking data safely</a></li>
  <li><a href="#freezing-structure-to-avoid-accidental-edits-and-improve-overview" id="toc-freezing-structure-to-avoid-accidental-edits-and-improve-overview" class="nav-link" data-scroll-target="#freezing-structure-to-avoid-accidental-edits-and-improve-overview">Freezing structure to avoid accidental edits and improve overview</a></li>
  <li><a href="#additional-excel-knowledge-relevant-to-common-failures" id="toc-additional-excel-knowledge-relevant-to-common-failures" class="nav-link" data-scroll-target="#additional-excel-knowledge-relevant-to-common-failures">Additional Excel knowledge relevant to common failures</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../days/day01.html">Course Days</a></li><li class="breadcrumb-item"><a href="../days/day01.html">Day 1 â€“ What â€˜goodâ€™ Data Is</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Day 1 â€“ What â€˜goodâ€™ Data Is</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
.figure-source {
  font-size: 0.85em;
  color: #666;
  text-align: right;
  margin-top: -1rem;
}
.data-flow-shell {
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    align-items: flex-start;
    border: 1px solid #e7e7e7;
    border-radius: 8px;
    padding: 1.5rem;
    background: #fff;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
}
.data-flow-shell input[type="radio"] {
    display: none;
}
.data-flow-shell .stage-list {
    flex: 1 1 240px;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
.data-flow-shell .stage-list label {
    display: block;
    padding: 0.75rem 1rem;
    border: 1px solid #d5d5d5;
    border-radius: 6px;
    background: #f8f8f8;
    cursor: pointer;
    font-weight: 600;
    transition: border-color 0.2s, background 0.2s;
}
.data-flow-shell .stage-list label span {
    display: block;
    font-size: 0.85em;
    color: #666;
    font-weight: 400;
}
.data-flow-shell .stage-list label:hover {
    border-color: #1f77b4;
}
.data-flow-shell .stage-details {
    flex: 2 1 360px;
    min-width: 280px;
    border: 1px solid #dfe3e8;
    border-radius: 8px;
    padding: 1rem 1.25rem;
    background: #fcfcfc;
}
.stage-details-panel {
    display: none;
    animation: fadeIn 0.2s ease;
}
.stage-details-panel h4 {
    margin-top: 0;
}
.stage-details-panel ul {
    margin-top: 0.25rem;
    padding-left: 1.1rem;
}
.stage-details-panel li {
    margin-bottom: 0.2rem;
}
.data-flow-shell .stage-details .placeholder {
    color: #777;
}
#stage-default:checked ~ .stage-list label[for="stage-default"],
#stage-a:checked ~ .stage-list label[for="stage-a"],
#stage-b:checked ~ .stage-list label[for="stage-b"],
#stage-c:checked ~ .stage-list label[for="stage-c"],
#stage-d:checked ~ .stage-list label[for="stage-d"],
#stage-e:checked ~ .stage-list label[for="stage-e"],
#stage-f:checked ~ .stage-list label[for="stage-f"],
#stage-g:checked ~ .stage-list label[for="stage-g"] {
    border-color: #1f77b4;
    background: #e6f2ff;
}
#stage-default:checked ~ .stage-details #detail-default,
#stage-a:checked ~ .stage-details #detail-a,
#stage-b:checked ~ .stage-details #detail-b,
#stage-c:checked ~ .stage-details #detail-c,
#stage-d:checked ~ .stage-details #detail-d,
#stage-e:checked ~ .stage-details #detail-e,
#stage-f:checked ~ .stage-details #detail-f,
#stage-g:checked ~ .stage-details #detail-g {
    display: block;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(4px); }
    to { opacity: 1; transform: translateY(0); }
}
@media (max-width: 720px) {
    .data-flow-shell {
        flex-direction: column;
    }
}
</style>
<section id="learning-goals" class="level2">
<h2 class="anchored" data-anchor-id="learning-goals">Learning goals</h2>
<p>By the end of this day, you should be able to:</p>
<ul>
<li>explain what data represents and what it does not</li>
<li>distinguish data lifecycles (stages) e.g.&nbsp;data entry, data storage, data analysis</li>
<li>recognize common sources of mistakes</li>
<li>learn core principles of data handling and management</li>
<li>use Excel to enter and structure biological data in a controlled way</li>
<li>understand that every dataset is a simplified representation of reality</li>
</ul>
<p>No prior experience with Excel or programming is required.</p>
<hr>
</section>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>Biology deals with complex, variable systems.</p>
<p>Data are <strong>not reality</strong>.<br>
Data are a <strong>structured representation</strong> of selected aspects of reality.</p>
<p>Before we analyze anything, we must understand:</p>
<ul>
<li>what was observed,</li>
<li>how it was recorded,</li>
<li>and what information was lost in the process.</li>
</ul>
<p>Poorly structured data cannot be rescued by sophisticated analysis later.</p>
<hr>
</section>
<section id="agenda" class="level2">
<h2 class="anchored" data-anchor-id="agenda">Agenda</h2>
<ul>
<li>Course overview and expectations</li>
<li>The data lifecycle (high level)</li>
<li>What Excel is good at â€” and where it fails</li>
<li>Real-world examples of silent data corruption</li>
<li>Reflection and outlook to Day 2</li>
</ul>
<p><strong>13:30â€“14:15 | Block 1 â€“ Introduction and course framing</strong></p>
<ul>
<li>Course is structured (5 days, Excel â†’ R)</li>
<li>How we will work: alone and in pairs, hands-on, reflection</li>
<li>Where materials, data, and exercises live (course website / GitHub)</li>
<li>Short introduction: who I am</li>
<li>Belize protected-area case study</li>
</ul>
<p><strong>14:15â€“14:30 | Break</strong> â˜•ï¸</p>
<p><strong>14:30â€“15:15 | Block 2 â€“ What data is (and what it is not)</strong></p>
<ul>
<li>Overview of the data lifecycle and where Excel fits in</li>
<li>FAIR: Findability, Acessibility, Interoperability, and Reusability</li>
<li>Examples of spreadsheet failures</li>
<li>Data vs reality: observations, variables, metadata</li>
<li>Data as a simplified representation of complex systems</li>
<li>Good vs bad tables: diagnosing common problems</li>
<li>Why structure matters more than software</li>
</ul>
<p><strong>15:15â€“15:30 | Break</strong> â˜•ï¸</p>
<p><strong>15:30â€“16:15 | Block 3 â€“ Hands-on: structured data entry in Excel</strong></p>
<ul>
<li>Rules for analysis-ready tables</li>
<li>Enter biodiversity monitoring data using a provided template</li>
<li>Work in pairs (driver / navigator)</li>
<li>Identify and discuss emerging inconsistencies</li>
</ul>
<p><strong>16:15â€“16:30 | Reflection, discussion, and outlook</strong> ğŸ§ </p>
<ul>
<li>What was harder than expected?</li>
<li>Which problems cannot be fixed later?</li>
<li>What questions remain open?</li>
<li>Preview of Day 2: summarizing and visualizing data</li>
</ul>
<hr>
</section>
<section id="context-a-real-world-case-study" class="level2">
<h2 class="anchored" data-anchor-id="context-a-real-world-case-study">Context: a real-world case study</h2>
<p>Throughout this course, we work with a simplified but real world scenario:</p>
<blockquote class="blockquote">
<p>You are working with biodiversity monitoring, conservation planing and foresty data from a national protected area in Belize.<br>
Data are collected by yourself, rangers, partner NGOs, and external consultants over long periods of time.</p>
</blockquote>
<hr>
</section>
<section id="what-is-data" class="level2">
<h2 class="anchored" data-anchor-id="what-is-data">What is data?</h2>
<p>Deliberately tool-agnostic and discipline-neutral.</p>
<div class="grid">
<div class="g-col-6">
<div class="card border-primary">
<div class="card-header bg-primary text-white">
<p>Short version</p>
</div>
<div class="card-body">
<p><strong>Data are recorded observations about the world.</strong></p>
</div>
</div>
</div>
<div class="g-col-6">
<div class="card border-primary">
<div class="card-header bg-primary text-white">
<p>Longer version</p>
</div>
<div class="card-body">
<p><strong>Data are representations of observations, measurements, or events</strong>, encoded in a form that allows <strong>storage, comparison, and interpretation</strong>.</p>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Data are <strong>not facts themselves</strong>, they are <strong>encodings of facts</strong>.</p>
</blockquote>
<p>This distinction matters: tools only operate on the encoding, never on reality.</p>
<hr>
</section>
<section id="core-comcepts-definition" class="level2">
<h2 class="anchored" data-anchor-id="core-comcepts-definition">Core comcepts definition</h2>
<p>In this course, we use the following working definitions:</p>
<ul>
<li><p><strong>Observation:</strong> something you perceive or record in the world<br>
e.g.&nbsp;one species observation at one location and time</p></li>
<li><p><strong>Measurement:</strong> an observation made using a rule or instrument<br>
e.g.&nbsp;â€œTree height = 12.4 m measured with a clinometer.â€</p></li>
<li><p><strong>Variable</strong>: a property that can vary between observations<br>
e.g.&nbsp;species name, height, location, date, time, count</p></li>
<li><p><strong>Data:</strong> the recorded representation of that measurement<br>
e.g.&nbsp;a value in a table: <code>height = 12.4</code></p></li>
<li><p><strong>Dataset</strong>: a collection of observations recorded in a structured form e.g.&nbsp;a spreadsheet or CSV file with many rows and columns</p></li>
<li><p><strong>Metadata</strong>: information about how, when, where, and why data were collected e.g.&nbsp;units, methods, location, observer, context</p></li>
</ul>
<p>Once written down, data are detached from the original context unless you preserve it.</p>
<hr>
</section>
<section id="what-counts-as-data-in-biology" class="level2">
<h2 class="anchored" data-anchor-id="what-counts-as-data-in-biology">What counts as data in biology?</h2>
<p>In biology, data can take many forms:</p>
<ul>
<li><strong>numbers</strong> (e.g.&nbsp;body mass, abundance, concentration)</li>
<li><strong>categories</strong> (e.g.&nbsp;species name, habitat type)</li>
<li><strong>text</strong> (e.g.&nbsp;field notes, descriptions)</li>
<li><strong>images</strong> (e.g.&nbsp;microscopy, camera traps)</li>
<li><strong>sequences</strong> (e.g.&nbsp;DNA, RNA, proteins)</li>
<li><strong>time series</strong> (e.g.&nbsp;temperature, population size)</li>
<li><strong>spatial coordinates</strong> (e.g.&nbsp;GPS locations)</li>
</ul>
<p><strong>Key point</strong><br>
Data are always <strong>abstractions of reality</strong>, never reality itself.</p>
<p>This is why interpretation without context is dangerous and wrong.</p>
<hr>
</section>
<section id="why-context-matters-metadata" class="level2">
<h2 class="anchored" data-anchor-id="why-context-matters-metadata">Why context matters: metadata</h2>
<p>Data without context are dangerous.</p>
<p>That context is called <strong>metadata</strong>, for example:</p>
<ul>
<li>units<br>
</li>
<li>methods<br>
</li>
<li>time<br>
</li>
<li>location<br>
</li>
<li>who collected it<br>
</li>
<li>how it was collected<br>
</li>
<li>what assumptions were made</li>
</ul>
<section id="example-there-is-data-and-there-is-data" class="level3">
<h3 class="anchored" data-anchor-id="example-there-is-data-and-there-is-data">Example: There is data, and there is data</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Recorded value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12.4</td>
<td>meaningless</td>
</tr>
<tr class="even">
<td>12.4 m</td>
<td>better</td>
</tr>
<tr class="odd">
<td>12.4 m; tree height; clinometer; dry season; treeID766; transect A; observer O. Hagen</td>
<td>usable</td>
</tr>
</tbody>
</table>
<p><strong>Rule of thumb:</strong><br>
- <strong>Data + metadata = information</strong><br>
- <strong>Data without metadata = confusion</strong></p>
<p>This is <em>exactly</em> why FAIR stresses <strong>rich metadata</strong> and standardization: without it, your â€œdataâ€ are not really reusable.</p>
<hr>
</section>
<section id="where-metadata-should-live-best-practice" class="level3">
<h3 class="anchored" data-anchor-id="where-metadata-should-live-best-practice">Where metadata should live (best practice)</h3>
<p>Excel sheets are <strong>bad at metadata</strong>. Do not rely on formatting or comments.</p>
<p>Use <strong>three layers</strong> instead:</p>
<ol type="1">
<li><strong>File name</strong></li>
</ol>
<p>Encodes place, year, content, and status.</p>
<ol start="2" type="1">
<li><strong>README file (outside Excel)</strong><br>
<code>README.md</code> or <code>README.txt</code></li>
</ol>
<p>Describe: - who collected the data - when and where - units - methods - known issues</p>
<ol start="3" type="1">
<li><strong>Dedicated metadata sheet (inside Excel)</strong><br>
</li>
</ol>
<ul>
<li>one sheet called <code>metadata</code></li>
<li>plain text only</li>
<li>no merged cells</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Risk of Excel-only metadata</strong></p>
<ul>
<li>formatting is lost on export<br>
</li>
<li>meaning disappears outside Excel<br>
</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="the-fair-principles-what-they-really-mean" class="level2">
<h2 class="anchored" data-anchor-id="the-fair-principles-what-they-really-mean">The FAIR principles (what they really mean)</h2>
<p>The FAIR principles describe how scientific data should be handled so that they remain <strong>useful beyond the moment they are collected</strong>.</p>
<p>FAIR does <strong>not</strong> mean â€œopen to everyoneâ€ and it does <strong>not</strong> guarantee data quality.<br>
FAIR means that data are prepared in a way that allows <strong>others (and your future self)</strong> to find, understand, and reuse them.</p>
<p>We present FAIR principles expanded from<br>
<a href="https://doi.org/10.1038/sdata.2016.18">Wilkinson et al.&nbsp;(2016), <em>The FAIR Guiding Principles for scientific data management and stewardship</em></a><br>
by the wider research data management community.</p>
<p><strong>FAIR</strong> stands for:</p>
<section id="findable" class="level3">
<h3 class="anchored" data-anchor-id="findable">ğŸ” Findable</h3>
<p><strong>What it means</strong><br>
Data can be <em>discovered</em> by humans and machines.</p>
<p><strong>In practice, this requires</strong> - a clear name or identifier - descriptive metadata - a stable location (repository, database, archive)</p>
<p><strong>Why it matters</strong> If data cannot be found, they effectively do not exist for science.</p>
<blockquote class="blockquote">
<p>A file on your laptop called <code>final_data_v3_REAL.xlsx</code> is not findable.</p>
</blockquote>
<hr>
</section>
<section id="accessible" class="level3">
<h3 class="anchored" data-anchor-id="accessible">ğŸ”“ Accessible</h3>
<p><strong>What it means</strong><br>
Once found, it is clear <strong>how the data can be accessed</strong>, even if access is restricted.</p>
<p><strong>In practice, this requires</strong> - a clear access procedure - documented permissions or licenses - long-term availability</p>
<p><strong>Why it matters</strong> Accessibility is about <em>clarity</em>, not openness.<br>
Even restricted data must explain <strong>how access works</strong>.</p>
<blockquote class="blockquote">
<p>â€œEmail the authorâ€ is not a sustainable access strategy.</p>
</blockquote>
<hr>
</section>
<section id="interoperable" class="level3">
<h3 class="anchored" data-anchor-id="interoperable">ğŸ”— Interoperable</h3>
<p><strong>What it means</strong><br>
Data can be combined with other data and used by different tools.</p>
<p><strong>In practice, this requires</strong> - standard formats (e.g.&nbsp;CSV, not proprietary-only files) - consistent units - controlled vocabularies - clear data types</p>
<p><strong>Why it matters</strong> If every dataset uses its own conventions, integration becomes untractable.</p>
<blockquote class="blockquote">
<p><code>12</code>, <code>12.0</code>, <code>12 m</code>, and <code>twelve</code> are not interoperable without context.</p>
</blockquote>
<hr>
</section>
<section id="reusable" class="level3">
<h3 class="anchored" data-anchor-id="reusable">â™»ï¸ Reusable</h3>
<p><strong>What it means</strong><br>
Data can be <strong>understood and used correctly</strong> in a new context.</p>
<p><strong>In practice, this requires</strong> - rich metadata - documented methods - clear assumptions - provenance (who did what, when, and how)</p>
<p><strong>Why it matters</strong> Reuse without context leads to misinterpretation and error.</p>
<blockquote class="blockquote">
<p>Data without metadata are numbers without meaning.</p>
</blockquote>
<hr>
</section>
</section>
<section id="data-are-not-neutral" class="level2">
<h2 class="anchored" data-anchor-id="data-are-not-neutral">Data are not neutral</h2>
<p>This is important and often missed.</p>
<p>Data depend on:</p>
<ul>
<li>what you chose to measure<br>
</li>
<li>what you ignored<br>
</li>
<li>instrument precision<br>
</li>
<li>human judgement<br>
</li>
<li>classification decisions</li>
</ul>
<p>In ecology, for example:</p>
<ul>
<li>species presence depends on <strong>detectability</strong><br>
</li>
<li>absence is rarely true absence<br>
</li>
<li>counts depend on <strong>effort</strong></li>
</ul>
<p>So data always embed theory, assumptions, and bias.</p>
<hr>
</section>
<section id="why-this-matters-for-tools-like-excel-and-r" class="level2">
<h2 class="anchored" data-anchor-id="why-this-matters-for-tools-like-excel-and-r">Why this matters for tools like Excel and R</h2>
<p>Tools donâ€™t understand meaning. They only manipulate symbols.</p>
<ul>
<li>Excel does not know what a species is.<br>
</li>
<li>R does not know what a tree is.<br>
</li>
<li>Both only see strings, numbers, and dates.</li>
</ul>
<p>Thatâ€™s why:</p>
<ul>
<li><strong>Excel can silently change your data</strong> (auto-conversion, formatting surprises)<br>
</li>
<li><strong>R forces you to be explicit</strong> (types, scripts, reproducible steps)</li>
</ul>
<p><strong>Bottom line:</strong> the responsibility for meaning stays with the scientist.</p>
<hr>
<hr>
</section>
<section id="data-as-a-model" class="level2">
<h2 class="anchored" data-anchor-id="data-as-a-model">Data as a model</h2>
<p>Every dataset is already a <strong>model</strong>:</p>
<ul>
<li>it includes some aspects of reality</li>
<li>it excludes others</li>
<li>it simplifies complex systems</li>
</ul>
<p>This idea will return later in statistics and modelling courses.</p>
<p>For now, remember:</p>
<blockquote class="blockquote">
<p>Data are never neutral.<br>
Choices are made at the moment of data collection.</p>
</blockquote>
<hr>
</section>
<section id="the-data-lifecycle" class="level2">
<h2 class="anchored" data-anchor-id="the-data-lifecycle">The Data lifecycle</h2>
<div class="data-flow-shell">
    <input type="radio" name="stage" id="stage-a">
    <input type="radio" name="stage" id="stage-b">
    <input type="radio" name="stage" id="stage-c">
    <input type="radio" name="stage" id="stage-d">
    <input type="radio" name="stage" id="stage-e">
    <input type="radio" name="stage" id="stage-f">
    <input type="radio" name="stage" id="stage-g">

    <div class="stage-list">
        <label for="stage-a">Data generation <span>Real-world measurements and observations</span></label>
        <label for="stage-b">Data entry &amp; initial structuring <span>Transcribing, defining rows/columns, first checks</span></label>
        <label for="stage-c">Data cleaning &amp; quality control <span>Fixing typos, harmonising codes, handling missing values</span></label>
        <label for="stage-d">Data storage &amp; archiving <span>Make data durable, portable, and shareable</span></label>
        <label for="stage-e">Data analysis <span>Statistics, models, simulations</span></label>
        <label for="stage-f">Visualization &amp; communication <span>Figures, tables, narratives</span></label>
        <label for="stage-g">Reproducibility &amp; reuse <span>Scripts, version control, sharing</span></label>
    </div>

    <div class="stage-details">
        <div class="stage-details-panel" id="detail-a">
            <h4 class="anchored">Data generation</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Data originate in the real world: measurements, observations, experiments, surveys, sensors, and field notes.</li>
            </ul>
            <p><strong>Biology examples</strong></p>
            <ul>
                <li>Species counts, trait measurements, GPS tracks, lab assays, environmental monitoring.</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>Field sheets, instruments, sensors, lab notebooks, electronic lab notebooks (ELNs).</li>
            </ul>
        </div>

        <div class="stage-details-panel" id="detail-b">
            <h4 class="anchored">Data entry &amp; initial structuring</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Transcribing observations into digital form.</li>
                <li>Defining rows, columns, identifiers, and units.</li>
                <li>Performing the very first human sanity checks.</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>Excel, Google Sheets, LibreOffice Calc, simple data entry forms.</li>
            </ul>
            <p><strong>Excel</strong>: âœ… Excellent when used carefully (fast manual entry, visual feedback, validation rules).</p>
            <p><strong>R</strong>: âš ï¸ Not designed for manual entry; it expects data files or databases.</p>
            <p><strong>Key rule</strong>: one row = one observation, one column = one variable, and no analysis logic in the raw file.</p>
        </div>

        <div class="stage-details-panel" id="detail-c">
            <h4 class="anchored">Data cleaning &amp; quality control</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Fixing typos, harmonising codes, handling missing values.</li>
                <li>Checking ranges, units, and consistency.</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>Excel (for transparent, small datasets), R, Python (pandas).</li>
            </ul>
            <p><strong>Excel</strong>: âš ï¸ Limited and risky because changes are hard to audit and history is lost.</p>
            <p><strong>R</strong>: âœ… Very strong â€” every cleaning step is scripted and reproducible.</p>
            <p><strong>Key transition</strong>: if you cannot explain exactly what you changed and why, leave Excel.</p>
        </div>

        <div class="stage-details-panel" id="detail-d">
            <h4 class="anchored">Data storage &amp; archiving</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Long-term storage, collaboration, and repository submission.</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>Plain-text tables (CSV/TSV), databases, Zenodo, Dryad, institutional servers.</li>
            </ul>
            <p><strong>Excel</strong>: âŒ Poor choice â€” hides metadata, embeds formulas, fragile across versions, hard to diff.</p>
            <p><strong>R</strong>: âš ï¸ Produces clean portable data files but is not itself the archive.</p>
        </div>

        <div class="stage-details-panel" id="detail-e">
            <h4 class="anchored">Data analysis</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Statistical summaries, models, hypothesis testing, simulations.</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>R, Python, specialized statistical software.</li>
            </ul>
            <p><strong>Excel</strong>: âŒ Danger zone â€” formulas are opaque, errors hard to detect, reproducibility is weak.</p>
            <p><strong>R</strong>: âœ… Core strength â€” transparent, testable, and scriptable analysis.</p>
        </div>

        <div class="stage-details-panel" id="detail-f">
            <h4 class="anchored">Visualization &amp; communication</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Figures, tables, reports, presentations.</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>R (ggplot2), Python (matplotlib, seaborn), Quarto, Illustrator for polishing.</li>
            </ul>
            <p><strong>Excel</strong>: âš ï¸ Fine for quick exploratory plots and sanity checks, but not for final reproducible figures.</p>
            <p><strong>R</strong>: âœ… Excellent control and consistency.</p>
        </div>

        <div class="stage-details-panel" id="detail-g">
            <h4 class="anchored">Reproducibility &amp; reuse</h4>
            <p><strong>What this stage is about</strong></p>
            <ul>
                <li>Others reusing your data, or you revisiting it months later.</li>
                <li>Reviewers asking â€œhow did you get this result?â€</li>
            </ul>
            <p><strong>Good tools</strong></p>
            <ul>
                <li>Scripts, version control (Git), Quarto/notebooks.</li>
            </ul>
            <p><strong>Excel</strong>: âŒ Actively hostile â€” undocumented and non-repeatable.</p>
            <p><strong>R</strong>: âœ… Designed for exact reruns with explicit provenance.</p>
        </div>
    </div>
</div>
<p>Excel is widely used because it is:</p>
<ul>
<li>easy to access</li>
<li>human-readable</li>
<li>flexible</li>
</ul>
<p>Excel is <strong>well suited</strong> for: - data entry - inspection - small-scale summaries</p>
<p>Excel is <strong>not well suited</strong> for: - enforcing consistency - documenting decisions - scaling analyses</p>
<p>Understanding these limits is part of digital competence.</p>
<hr>
</section>
<section id="spreadsheet-failures-lead-to-financial-policy-and-health-costs" class="level2">
<h2 class="anchored" data-anchor-id="spreadsheet-failures-lead-to-financial-policy-and-health-costs">Spreadsheet Failures lead to Financial, Policy, and Health Costs</h2>
<p>Before we look at biological and environmental data, it is worth understanding <em>why spreadsheets deserve respect</em>. The cases below are not about beginners. They involve intelligence agencies, governments, banks, and elite academics.</p>
<p>These failures occurred because spreadsheets silently changed data, hid assumptions, or scaled beyond what they were designed for.</p>
<section id="why-excel-behaves-the-way-it-does" class="level3">
<h3 class="anchored" data-anchor-id="why-excel-behaves-the-way-it-does">Why Excel behaves the way it does</h3>
<p>Excel is designed for convenience, not scientific safety.</p>
<p>It assumes: - dates are more common than gene names - numbers should be auto-formatted - users want speed, not explicitness</p>
<p>The following examples are not edge cases. They are the logical consequence of these design choices.</p>
<hr>
</section>
<section id="mi5-wiretapped-the-wrong-people" class="level3">
<h3 class="anchored" data-anchor-id="mi5-wiretapped-the-wrong-people">ğŸ•µï¸ğŸ“ğŸ¯âŒ MI5 wiretapped the wrong people</h3>
<p><em>(UK intelligence error)</em> <strong>Source:</strong> <a href="https://www.theguardian.com/technology/2024/oct/28/microsoft-excels-bloopers-reel-40-years-of-spreadsheet-errors" target="_blank" rel="noopener">The Guardian</a></p>
<p>A spreadsheet formatting issue altered the last three digits of phone numbers to <code>000</code>, leading to <strong>134 incorrect surveillance targets</strong>. The error originated from automatic formatting in a spreadsheet.</p>
<p><strong>Lesson</strong></p>
<ul>
<li>Automatic data conversion can silently change identifiers.</li>
</ul>
<p><strong>Why it matters</strong></p>
<ul>
<li>Intelligence and security systems rely on <em>exact identifiers</em>.</li>
<li>A single formatting error can redirect surveillance to innocent people.</li>
</ul>
<hr>
</section>
<section id="nearly-16000-covid-19-cases-lost-in-england" class="level3">
<h3 class="anchored" data-anchor-id="nearly-16000-covid-19-cases-lost-in-england">ğŸ¦ ğŸ“‰ğŸš«ğŸ“‹ Nearly 16,000 COVID-19 cases lost in England</h3>
<p><em>(Public health reporting failure)</em> <strong>Source:</strong> <a href="https://www.theguardian.com/politics/2020/oct/05/how-excel-may-have-caused-loss-of-16000-covid-tests-in-england" target="_blank" rel="noopener">The Guardian</a></p>
<p>During the COVID-19 pandemic, <strong>15,841 positive cases</strong> were omitted from official statistics because a CSV file was opened in Excel and <strong>truncated at the row limit</strong>. (i.e.&nbsp;65,536 for the used version). Contact tracing was delayed and incomplete as a result. Can we even calculate the true impact of these errors?</p>
<blockquote class="blockquote">
<p>In modern Microsoft Excel (including Office 365 / Microsoft 365) the maximum number of rows per worksheet is 1,048,576. You cannot add more rows in a single sheet beyond that limit; if you try to import data that exceeds this, rows beyond the limit may be truncated. The maximum number of columns is 16,384 (column XFD Support Microsoft).</p>
</blockquote>
<p><strong>Lesson</strong></p>
<ul>
<li>Excel has <em>hard limits</em> (row counts) that are invisible until exceeded.</li>
</ul>
<p><strong>Why it matters</strong></p>
<ul>
<li>Incomplete data leads to flawed epidemiological response.</li>
<li>Delayed contact tracing can plausibly translate into <strong>preventable infections and deaths</strong>.</li>
</ul>
<hr>
</section>
<section id="reinhart-rogoff-economic-growth-error" class="level3">
<h3 class="anchored" data-anchor-id="reinhart-rogoff-economic-growth-error">ğŸ“Šâ—âš ï¸ğŸ›ï¸ Reinhart &amp; Rogoff economic growth error</h3>
<p><em>(Influential academic policy failure)</em> <strong>Source:</strong> <a href="https://www.theguardian.com/technology/2024/oct/28/microsoft-excels-bloopers-reel-40-years-of-spreadsheet-errors" target="_blank" rel="noopener">The Guardian</a>, <a href="https://retractionwatch.com/2013/04/18/influential-reinhart-rogoff-economics-paper-suffers-database-error/">Retraction Watch</a></p>
<p>A highly cited economic study claimed that countries with debt above 90% of GDP experienced sharply reduced growth. It was later discovered that an <strong>Excel formula excluded large parts of the data</strong>, significantly altering the result.</p>
<p><strong>Lesson</strong></p>
<ul>
<li>Hidden formula errors can persist even in peer-reviewed research.</li>
</ul>
<p><strong>Why it matters</strong></p>
<ul>
<li>This work influenced <strong>austerity policies worldwide</strong>.</li>
<li>Spreadsheet mistakes can shape economic policy affecting millions.</li>
</ul>
<hr>
</section>
<section id="fannie-mae-misreported-over-1-billion" class="level3">
<h3 class="anchored" data-anchor-id="fannie-mae-misreported-over-1-billion">ğŸ’°ğŸ“‘âŒğŸ¦ Fannie Mae misreported over $1 billion</h3>
<p><em>(Financial reporting failure)</em> <strong>Source:</strong> <a href="https://www.theguardian.com/technology/2024/oct/28/microsoft-excels-bloopers-reel-40-years-of-spreadsheet-errors" target="_blank" rel="noopener">The Guardian</a></p>
<p>In 2003, the U.S. mortgage giant reported quarterly results containing <strong>over $1 billion in accounting errors</strong>, traced back to an incorrect Excel formula.</p>
<p><strong>Lesson</strong></p>
<ul>
<li>Formula logic in spreadsheets is rarely audited or tested.</li>
</ul>
<p><strong>Why it matters</strong></p>
<ul>
<li>Financial misreporting undermines investor trust and regulatory oversight.</li>
<li>Small spreadsheet mistakes can become <em>material financial risks</em>.</li>
</ul>
<hr>
</section>
<section id="jpmorgan-london-whale-6-billion-loss" class="level3">
<h3 class="anchored" data-anchor-id="jpmorgan-london-whale-6-billion-loss">ğŸ‹ğŸ“‰ğŸ’£ğŸ¦ JPMorgan â€œLondon Whaleâ€ $6 billion loss</h3>
<p><em>(Risk modelling failure)</em> <strong>Source:</strong> <a href="https://www.theguardian.com/technology/2024/oct/28/microsoft-excels-bloopers-reel-40-years-of-spreadsheet-errors" target="_blank" rel="noopener">The Guardian</a></p>
<p>A trading loss of approximately <strong>$6 billion</strong> was linked to risk models managed through manually edited Excel spreadsheets. Cut-and-paste workflows and poor version control amplified risk.</p>
<p><strong>Lesson</strong><br>
- Manual workflows lack audit trails and reproducibility.</p>
<p><strong>Why it matters</strong><br>
- Risk systems must be automated, tested, and transparent. - Spreadsheet-based models do not scale safely.</p>
<hr>
</section>
</section>
<section id="spreadsheet-failures-in-biology-and-environmental-sciences" class="level2">
<h2 class="anchored" data-anchor-id="spreadsheet-failures-in-biology-and-environmental-sciences">Spreadsheet Failures in Biology and Environmental Sciences</h2>
<p>Spreadsheet misuse has caused <strong>systematic scientific errors</strong>, not just technical inconveniences. These are particularly relevant for biologists, where identifiers, codes, and metadata matter. The case study below is a more in depth examples in genomics. However, all the issues above are also applicable to many Environmental and Ecological data.</p>
<section id="gene-name-auto-conversion-errors-in-genomics" class="level3">
<h3 class="anchored" data-anchor-id="gene-name-auto-conversion-errors-in-genomics">ğŸ§¬ğŸ“…âŒğŸ“Š Gene name auto-conversion errors in genomics</h3>
<p>Spreadsheet software automatically converts certain character strings into dates or numbers. In genomics, this silently corrupts gene names such as <code>SEPT2</code>, <code>MARCH1</code>, or <code>DEC1</code>, which are converted into dates (e.g.&nbsp;<code>2-Sep</code>, <code>1-Mar</code>, <code>1-Dec</code>) without warning.</p>
<p>Large-scale scans of published supplementary Excel files show that <strong>around 30% of papers containing gene lists are affected</strong>.</p>
<div class="external-figure">
<p><strong>Prevalence of Excel-induced gene name errors over time</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1008984.g001&amp;type=large" class="img-fluid figure-img"></p>
<figcaption>Excel-induced gene name errors over time</figcaption>
</figure>
</div>
<div class="figure-source">
<p>Source: <a href="https://doi.org/10.1371/journal.pcbi.1008984" target="_blank" rel="noopener">Abeysooriya et al.&nbsp;(2021), PLoS Computational Biology</a></p>
</div>
</div>
<blockquote class="blockquote">
<p>â€œThis [the error] is due to gene names being converted not just to dates and floating-point numbers, but also to internal date format (five-digit numbers). (Abeysooriya et al.&nbsp;2021)â€</p>
</blockquote>
<p><strong>Concept that would have prevented this</strong></p>
<ul>
<li>Explicit data typing (text â‰  date â‰  number)</li>
<li>Avoiding spreadsheet auto-formatting for identifier columns</li>
<li>Using plain-text formats (CSV/TSV) with scripted imports</li>
</ul>
<hr>
</section>
</section>
<section id="what-all-these-failures-have-in-common" class="level2">
<h2 class="anchored" data-anchor-id="what-all-these-failures-have-in-common">What all these failures have in common</h2>
<p>Across intelligence, finance, economics, public health, and scientific research the same patterns recur:</p>
<ul>
<li>Silent data transformation<br>
</li>
<li>Hidden assumptions and formulas<br>
</li>
<li>Hard limits that are easy to exceed<br>
</li>
<li>No version control or audit trail<br>
</li>
<li>Tools used beyond their design scope</li>
<li>Organic design / Changing specs</li>
<li>Lack of testing</li>
<li>Lack of relevant knowledge and skills</li>
</ul>
<p><strong>Spreadsheets did exactly what they were told.<br>
Humans misunderstood what they were doing.</strong></p>
<p>This is why learning to use these tools <em>properly</em> matters. And this is why this course starts with Excel discipline, but does not end there.</p>
<section id="concept-that-would-have-prevented-this" class="level3">
<h3 class="anchored" data-anchor-id="concept-that-would-have-prevented-this">Concept that would have prevented this</h3>
<ul>
<li>Separation of raw data and derived results</li>
<li>Version control instead of manual file duplication</li>
<li>Explicit metadata and data dictionaries</li>
<li>Well designed data entry</li>
<li>Skilled and knowledgeable users</li>
<li>Treating spreadsheets as <em>data entry interfaces</em> and <em>quick overview tools</em>, not databases</li>
<li>Validation rules and controlled vocabularies</li>
<li>Early transition to scripted, reproducible workflows</li>
</ul>
</section>
<section id="core-data-concepts-reinforced-by-these-cases" class="level3">
<h3 class="anchored" data-anchor-id="core-data-concepts-reinforced-by-these-cases">Core data concepts reinforced by these cases</h3>
<p>Across all examples, the same principles recur:</p>
<ul>
<li><strong>Data types must be explicit</strong></li>
<li><strong>Identifiers must never be auto-transformed</strong></li>
<li><strong>Raw data must be immutable</strong></li>
<li><strong>Analysis must be reproducible</strong> (easier in script languages, but more on day 3)</li>
<li><strong>Metadata is part of the data</strong></li>
</ul>
<p>These principles motivate why this course starts with Excel discipline, but quickly moves to R and Quarto.</p>
<hr>
</section>
</section>
<section id="excel-as-a-data-tool" class="level2">
<h2 class="anchored" data-anchor-id="excel-as-a-data-tool">Excel as a data tool</h2>
<p>Used correctly, Excel helps you:</p>
<ul>
<li>enter data consistently</li>
<li>inspect data visually</li>
<li>detect obvious errors early</li>
</ul>
<p>Used incorrectly, Excel:</p>
<ul>
<li>silently changes data</li>
<li>mixes metadata, logic, and values</li>
<li>hides errors in formatting and formulas</li>
</ul>
<p>The goal is <strong>discipline</strong>, not Excel mastery.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are alternatives to Excel (Google Sheets, LibreOffice Calc), but the principles remain the same.</p>
</div>
</div>
<hr>
</section>
<section id="file-formats-metadata-and-storage" class="level2">
<h2 class="anchored" data-anchor-id="file-formats-metadata-and-storage">File formats, metadata, and storage</h2>
<section id="common-excel-related-file-formats" class="level3">
<h3 class="anchored" data-anchor-id="common-excel-related-file-formats">Common Excel-related file formats</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 31%">
<col style="width: 34%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Format</th>
<th>What it is</th>
<th>When to use</th>
<th>Risks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>.xlsx</code></td>
<td>Native Excel workbook</td>
<td>Data entry, inspection</td>
<td>Proprietary, hides metadata</td>
</tr>
<tr class="even">
<td><code>.xls</code></td>
<td>Legacy Excel</td>
<td>Avoid</td>
<td>Obsolete, fragile</td>
</tr>
<tr class="odd">
<td><code>.csv</code></td>
<td>Comma-separated values</td>
<td>Exchange, archiving</td>
<td>No metadata, no types, no formatting, no sheets</td>
</tr>
<tr class="even">
<td><code>.tsv</code></td>
<td>Tab-separated values</td>
<td>Exchange, robust to commas</td>
<td>Same limits as CSV</td>
</tr>
<tr class="odd">
<td><code>.txt</code></td>
<td>Plain text with delimiter</td>
<td>Maximum compatibility</td>
<td>Needs careful import</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key rule</strong></p>
<ul>
<li>Work in <code>.xlsx</code></li>
<li>Archive and share in <code>.csv</code> / <code>.tsv</code></li>
</ul>
</div>
</div>
</section>
<section id="separators-delimiters-commas-tabs-semicolons-and-why-they-matter" class="level3">
<h3 class="anchored" data-anchor-id="separators-delimiters-commas-tabs-semicolons-and-why-they-matter">Separators (delimiters): commas, tabs, semicolons, and why they matter</h3>
<p>Plain-text data files (<code>.csv</code>, <code>.tsv</code>, <code>.txt</code>) store tables using <strong>separators</strong> (also called <em>delimiters</em>) to mark where one column ends and the next begins.</p>
<p>Excel does not store separators inside <code>.xlsx</code> files, but <strong>relies on them heavily when importing and exporting text data</strong>.</p>
<hr>
</section>
<section id="common-separators-you-will-encounter" class="level3">
<h3 class="anchored" data-anchor-id="common-separators-you-will-encounter">Common separators you will encounter</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 29%">
<col style="width: 23%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Separator</th>
<th>File extension</th>
<th>Typical use</th>
<th>Common problems</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Comma <code>,</code></td>
<td><code>.csv</code></td>
<td>Default in many countries</td>
<td>Conflicts with decimal commas</td>
</tr>
<tr class="even">
<td>Semicolon <code>;</code></td>
<td><code>.csv</code></td>
<td>Common in Europe</td>
<td>Misread by software expecting commas</td>
</tr>
<tr class="odd">
<td>Tab <code>\t</code></td>
<td><code>.tsv</code></td>
<td>Scientific data exchange</td>
<td>Invisible, but robust</td>
</tr>
<tr class="even">
<td>Pipe <code>|</code></td>
<td><code>.txt</code></td>
<td>Rare, custom exports</td>
<td>Requires manual import</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="why-separators-break-things" class="level3">
<h3 class="anchored" data-anchor-id="why-separators-break-things">Why separators break things</h3>
<p>Separators fail when they <strong>collide with content</strong>.</p>
<p>Examples:</p>
<ul>
<li>commas inside text fields (species names, notes)</li>
<li>decimal commas vs decimal points</li>
<li>inconsistent exports across operating systems</li>
<li>Excel guessing the wrong delimiter</li>
</ul>
<div class="callout-danger">
<p>A file can be syntactically valid and still be interpreted incorrectly.</p>
</div>
<hr>
</section>
<section id="csv-is-not-a-standard-this-surprises-many-people" class="level3">
<h3 class="anchored" data-anchor-id="csv-is-not-a-standard-this-surprises-many-people">CSV is not a standard (this surprises many people)</h3>
<p>Despite its name, <strong>CSV has no single global standard</strong>.</p>
<p>CSV files vary by:</p>
<ul>
<li>separator (<code>,</code> vs <code>;</code>)</li>
<li>decimal symbol (<code>.</code> vs <code>,</code>)</li>
<li>text encoding</li>
<li>quoting rules</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What if the data itself contains a my separator?
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a value contains a separator, it must be <strong>wrapped in double quotes</strong></p>
<p>Example:</p>
<p>plot_id, species, notes</p>
<p>1, Iguana iguana, â€œobserved near river, basking on rockâ€</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try out creating a csv and a xlsx with comma and quotes as above (5 min)
</div>
</div>
<div class="callout-body-container callout-body">
<p>From Excel</p>
<ol type="1">
<li>Create a new sheet with the data above</li>
<li>Save as <code>.csv</code> and inspect the file in a text editor</li>
</ol>
<p>From text editor</p>
<ol type="1">
<li>Create a new text file with the data above</li>
<li>Save as <code>.csv</code> and open in Excel</li>
<li>Afters inspecting, remove the last quote and re-open in Excel. What happens?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What if the data contains double quote
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a value contains a double quote â€œ, you escape it by <strong>doubling it</strong>.</p>
<p>plot_id, species, notes</p>
<p>1, Iguana iguana, â€œobservedâ€â€œnearâ€â€ river, basking on rockâ€</p>
</div>
</div>
<hr>
</section>
<section id="tsv-is-often-safer-than-csv" class="level3">
<h3 class="anchored" data-anchor-id="tsv-is-often-safer-than-csv">TSV is often safer than CSV</h3>
<p>Tab-separated values (<code>.tsv</code>) are preferred in science because:</p>
<ul>
<li>tabs rarely appear in text</li>
<li>commas inside values do not break columns</li>
<li>human-readable and machine-friendly</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you can choose: <strong>prefer TSV over CSV</strong>.</p>
</div>
</div>
<hr>
</section>
<section id="how-excel-decides-which-separator-to-use" class="level3">
<h3 class="anchored" data-anchor-id="how-excel-decides-which-separator-to-use">How Excel decides which separator to use</h3>
<p>Excel uses: - <strong>system locale settings</strong> - <strong>regional settings</strong> - <strong>guessing</strong></p>
<p>This means:</p>
<ul>
<li>the same file opens differently on different machines ğŸ˜–</li>
<li>the same file opens differently on Windows vs macOS ğŸ¤®</li>
</ul>
<hr>
</section>
<section id="text-encodings" class="level3">
<h3 class="anchored" data-anchor-id="text-encodings">Text encodings</h3>
<p>Text files do not store letters directly.<br>
They store <strong>numbers</strong> that represent characters.<br>
A <strong>text encoding</strong> defines how those numbers map to letters, symbols, and accents.</p>
<p>If you feel motivated, check out <a href="https://www.youtube.com/watch?v=ut74oHojxqo">this 10min video explaining encoding and related concepts</a></p>
<p>Common encodings you will encounter:</p>
<ul>
<li><strong>UTF-8</strong>: modern standard, cross-platform, supports all languages</li>
<li><strong>Windows-1252 / Latin-1</strong>: older, limited, Windows-specific</li>
<li><strong>MacRoman</strong>: obsolete legacy format</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Best practice</strong></p>
<p>Always use <strong>UTF-8</strong> for data files.</p>
</div>
</div>
</section>
</section>
<section id="encodings-are-invisible-until-they-break." class="level2">
<h2 class="anchored" data-anchor-id="encodings-are-invisible-until-they-break.">Encodings are invisible until they break.</h2>
<p>You only notice encodings when something goes wrong:</p>
<p>Ã¤ becomes ÃƒÂ¤</p>
<p>Âµ becomes Ã‚Âµ</p>
<p>symbols turn into ï¿½</p>
<p>column names become unreadable</p>
<p>At that point, the problem is already in the data, not just on the screen.</p>
<hr>
</section>
<section id="hands-on-session-structured-data-entry" class="level2">
<h2 class="anchored" data-anchor-id="hands-on-session-structured-data-entry">Hands-on session: structured data entry</h2>
<div class="text-center">
<p><img src="../assets/images/excelMEME.jpg" class="img-fluid" width="220"></p>
</div>
<section id="training-datasets-and-templates" class="level3">
<h3 class="anchored" data-anchor-id="training-datasets-and-templates">Training datasets and templates</h3>
<p>All practice files in <code>data/raw</code> and <code>data/templates</code> originate from the actual Belize protected-area monitoring programme plus the <a href="https://doi.org/10.1038/s41559-025-02702-x">Sanchez-Martinez et al.&nbsp;2025</a> drought-throughfall experiment and other linked datasets that will be downloaded directly. They have been lightly anonymized (IDs scrambled, locations jittered, sensitive observer metadata removed) to satisfy data privacy, permitting, and compliance rules while keeping the true structure we work with in the field. Because this site renders straight from GitHub, the following links open the exact files in the public repository.</p>
<section id="dataraw" class="level4">
<h4 class="anchored" data-anchor-id="dataraw"><code>data/raw</code></h4>
<ul>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/raw/csv/Caxiuana_tree_trait_data.csv"><code>csv/Caxiuana_tree_trait_data.csv</code></a> â€“ canopy-throughfall trait table exported exactly as received from UKCEH, with only tree IDs hashed for privacy.</li>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/raw/csv/Caxiuana_tree_trait_data_info.rtf"><code>csv/Caxiuana_tree_trait_data_info.rtf</code></a> â€“ companion metadata sheet (variables, methods, sensor notes) for the trait table.</li>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/tree/main/data/raw/Foresty/GAP_Data_2019"><code>Foresty/GAP_Data_2019</code></a> and <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/tree/main/data/raw/Foresty/GAP_Data_2020"><code>Foresty/GAP_Data_2020</code></a> â€“ seasonal canopy-gap (GAP) monitoring exports for four permanent transects (files <code>GAP_2014.05_*</code> through <code>GAP_2018.02_*</code>) with sensitive stand IDs redacted.</li>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/tree/main/data/raw/Foresty/PLOT_Data_2019"><code>Foresty/PLOT_Data_2019</code></a> and <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/tree/main/data/raw/Foresty/PLOT_Data_2020"><code>Foresty/PLOT_Data_2020</code></a> â€“ full-plot remeasurement workbooks for the same transects, cleaned only for ranger names and GPS precision.</li>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/raw/PSP/PSP_NPD42_OH.xlsx"><code>PSP/PSP_NPD42_OH.xlsx</code></a> and <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/raw/PSP/PSP_NPD847_OH.xlsx"><code>PSP/PSP_NPD847_OH.xlsx</code></a> â€“ Permanent Sample Plot (PSP) field exports with trunk/branch measurements, now using pseudonymous plot codes.</li>
</ul>
</section>
<section id="datatemplates" class="level4">
<h4 class="anchored" data-anchor-id="datatemplates"><code>data/templates</code></h4>
<ul>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/templates/PSP/PSP_#####_SFBC.xlsx"><code>PSP/PSP_#####_SFBC.xlsx</code></a> â€“ the clean data-entry template we fill during the field survey; replace <code>#####</code> with your plot code.</li>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/templates/PSP/README.docx"><code>PSP/README.docx</code></a> and <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/templates/PSP/%5BYYYYMM%5D_PSP_report.docx"><code>PSP/[YYYYMM]_PSP_report.docx</code></a> â€“ documentation that explains how rangers complete the template and assemble the monthly PSP report for supervisors.</li>
<li><a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/templates/PSP/DW.png"><code>PSP/DW.png</code></a> and <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/templates/PSP/DW2.png"><code>PSP/DW2.png</code></a> â€“ quick-reference visuals used in the field to remind teams of the DBH workflow and measurement checks.</li>
</ul>
</section>
</section>
</section>
<section id="importing-csv-tsv-and-delimited-text-correctly" class="level2">
<h2 class="anchored" data-anchor-id="importing-csv-tsv-and-delimited-text-correctly">Importing CSV, TSV, and delimited text correctly</h2>
<div class="callout-danger">
<p><strong>Refrain from double-clicking a CSV file.</strong></p>
<p>That is how Excel destroys data.</p>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group exercise: Spot possible problems (10 min)
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Open the provided spreadsheets:</li>
</ol>
<ul>
<li>Download and check <a href="http://journals.plos.org/plosone/article/asset?unique&amp;id=info:doi/10.1371/journal.pone.0145247.s002">this supplementary material excel sheet</a>/ hands on example on gene name errors in genomics</li>
<li>Open <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/raw/csv/Caxiuana_tree_trait_data.csv"><code>csv/Caxiuana_tree_trait_data.csv</code></a> by double-clicking it (bad practice, but common) as well as inspecting it in a text editor (e.g.&nbsp;Notepad, VSCode, TextEdit).</li>
</ul>
<p>Identify <strong>data structure and separators</strong>, <strong>potential data integrity issues</strong> as well as possible <strong>Excel misbehavior</strong>.</p>
<ul>
<li>Do not fix anything yet<br>
</li>
<li>Just write down what looks suspicious</li>
</ul>
</div>
</div>
<section id="correct-import-workflow-excel-365" class="level3">
<h3 class="anchored" data-anchor-id="correct-import-workflow-excel-365">Correct import workflow (Excel 365)</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group exercise: Import CSV safely (10 min)
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Steps</strong></p>
<ol type="1">
<li><code>Data â†’ Get Data â†’ From Text/CSV</code></li>
<li>Select the file <a href="https://github.com/ohagen/course_DigitalCompetenceInTheBiologicalSciences/blob/main/data/raw/csv/Caxiuana_tree_trait_data.csv"><code>csv/Caxiuana_tree_trait_data.csv</code></a></li>
<li>Inspect:
<ul>
<li>delimiter (comma, tab, semicolon)</li>
<li>decimal separator</li>
<li>encoding (UTF-8)</li>
</ul></li>
<li><strong>Explicitly set column data types</strong></li>
<li>Click <em>Load</em></li>
</ol>
<p>Alternatively you can use:</p>
<ol type="1">
<li><code>Data â†’ From Text/CSV</code></li>
</ol>
</div>
</div>
<p>This prevents: - automatic date conversion - loss of leading zeros - unwanted scientific notation</p>
<hr>
</section>
</section>
<section id="common-data-formats-inside-excel-and-how-to-use-them" class="level2">
<h2 class="anchored" data-anchor-id="common-data-formats-inside-excel-and-how-to-use-them">Common data formats inside Excel (and how to use them)</h2>
<p>Excel cells always have <strong>two things</strong>: - a value - a format</p>
<p>Confusing these causes errors.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Format</th>
<th>Use for</th>
<th>Common mistake</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Text</td>
<td>IDs, codes, species names</td>
<td>Auto-conversion</td>
</tr>
<tr class="even">
<td>Number</td>
<td>Counts, measurements</td>
<td>Mixed units</td>
</tr>
<tr class="odd">
<td>Date</td>
<td>Dates only</td>
<td>IDs converted to dates</td>
</tr>
<tr class="even">
<td>Time</td>
<td>Time of day</td>
<td>Mixed with dates</td>
</tr>
<tr class="odd">
<td>Logical</td>
<td>TRUE / FALSE</td>
<td>Stored as text</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Rule</strong></p>
<p>Identifiers are <strong>text</strong>, never numbers.</p>
</div>
</div>
<hr>
</section>
<section id="defining-data-formats-explicitly-minimum-discipline" class="level2">
<h2 class="anchored" data-anchor-id="defining-data-formats-explicitly-minimum-discipline">Defining data formats explicitly (minimum discipline)</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Steps</strong></p>
<ol type="1">
<li>Select the column</li>
<li>Right-click â†’ <em>Format Cells</em></li>
<li>Set:
<ul>
<li>Text for IDs</li>
<li>Number (fixed decimals) for measurements</li>
<li>Date (explicit format) for dates</li>
</ul></li>
</ol>
</div>
</div>
<p>This prevents Excel from â€œhelpingâ€. Try this out in any of the files.</p>
<hr>
</section>
<section id="using-formatting-to-understand-data-not-decorate-it" class="level2">
<h2 class="anchored" data-anchor-id="using-formatting-to-understand-data-not-decorate-it">Using formatting to understand data (not decorate it)</h2>
<p>Formatting is for <strong>error detection</strong> and <strong>data visualization</strong>, not aesthetics.</p>
<section id="minimal-but-effective-practices" class="level3">
<h3 class="anchored" data-anchor-id="minimal-but-effective-practices">Minimal but effective practices</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>View â†’ Freeze Top Row</code> (column headers)</li>
<li><code>View â†’ Freeze Panes</code> (ID columns)</li>
<li>Conditional formatting to:
<ul>
<li>flag missing values</li>
<li>highlight out-of-range values</li>
<li>reveal impossible measurements</li>
</ul></li>
</ul>
</div>
</div>
<p>Excel becomes a <strong>visual validator</strong>, not a calculator. Using those makes it harder to create and miss errors as well as for interpreting data.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alone: Play with PSP and GAP data files (10 min)
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Open any of the PSP or GAP data files.</li>
<li>Identify at least three columns that need explicit formatting.</li>
<li>Apply the correct format to each column.</li>
<li>Use formatting to check extreme values and missing data. <strong>Bonus</strong>. Check PSP/PSP_NPD42_OH.xlsx and see if you can spot any data issues</li>
</ol>
</div>
</div>
<hr>
</section>
</section>
<section id="limiting-data-entry-to-avoid-mistakes" class="level2">
<h2 class="anchored" data-anchor-id="limiting-data-entry-to-avoid-mistakes">Limiting data entry (to avoid mistakes)</h2>
<section id="data-validation-essential" class="level3">
<h3 class="anchored" data-anchor-id="data-validation-essential">Data validation (essential)</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Steps</strong></p>
<ol type="1">
<li>Select target cells or column</li>
<li><code>Data â†’ Data Validation</code></li>
<li>Choose:
<ul>
<li>numeric range</li>
<li>whole numbers only</li>
<li>allowed values</li>
<li>no blanks</li>
</ul></li>
<li>Add an input message if useful</li>
</ol>
</div>
</div>
<p>This stops bad data <strong>before it enters the table</strong>.</p>
<hr>
</section>
<section id="creating-drop-down-lists-controlled-vocabularies" class="level3">
<h3 class="anchored" data-anchor-id="creating-drop-down-lists-controlled-vocabularies">Creating drop-down lists (controlled vocabularies)</h3>
<p>Use drop-downs for: - habitat types - sex - life stage - presence / absence - categories</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Steps to create a drop-down list</strong></p>
<ol type="1">
<li>Create a list of allowed values (preferably on a separate sheet)</li>
<li>Select the target cells</li>
<li><code>Data â†’ Data Validation</code></li>
<li>Under <em>Allow</em>, choose <strong>List</strong></li>
<li>Set the source range (or type values manually)</li>
<li>Confirm</li>
</ol>
</div>
</div>
<p>This enforces consistency and avoids spelling variants.</p>
<hr>
</section>
</section>
<section id="avoiding-copy-paste-disasters" class="level2">
<h2 class="anchored" data-anchor-id="avoiding-copy-paste-disasters">Avoiding copy-paste disasters</h2>
<p>Copy-paste is one of the biggest sources of silent errors.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Defensive rules</strong></p>
<ul>
<li>Never insert rows inside data blocks</li>
<li>Never mix formulas and raw data</li>
<li>Keep raw data <strong>formula-free</strong></li>
<li>Use <em>Paste Special â†’ Values</em></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Structural rule</strong></p>
<p>One sheet = one table<br>
No blank rows<br>
No blank columns</p>
</div>
</div>
<hr>
</section>
<section id="sorting-and-ranking-data-safely" class="level2">
<h2 class="anchored" data-anchor-id="sorting-and-ranking-data-safely">Sorting and ranking data safely</h2>
<div class="callout-danger">
<p>Sorting a single column <strong>corrupts the dataset</strong>. Excel will not warn you.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Safe sorting workflow</strong></p>
<ol type="1">
<li>Select the <strong>entire table</strong></li>
<li><code>Data â†’ Sort</code></li>
<li>Confirm <em>Expand selection</em></li>
</ol>
</div>
</div>
<hr>
</section>
<section id="freezing-structure-to-avoid-accidental-edits-and-improve-overview" class="level2">
<h2 class="anchored" data-anchor-id="freezing-structure-to-avoid-accidental-edits-and-improve-overview">Freezing structure to avoid accidental edits and improve overview</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Protect sheets after data entry</li>
<li>Lock identifier columns</li>
<li>Allow edits only where needed</li>
</ul>
</div>
</div>
<p>This is basic but powerful.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Locking structure (actual protection)</strong></p>
<p>Excel locks cells in two steps.</p>
<p><strong>Step 1: Unlock cells that may be edited</strong></p>
<ol type="1">
<li><p>Select the cells that users are allowed to edit</p></li>
<li><p>Right-click â†’ <em>Format Cells</em></p></li>
<li><p>Go to the <em>Protection</em> tab</p></li>
<li><p>Uncheck <strong>Locked</strong></p></li>
<li><p>Click <em>OK</em></p></li>
</ol>
<p><strong>Step 2: Protect the sheet</strong></p>
<ol type="1">
<li><p>Go to <code>Review â†’ Protect Sheet</code></p></li>
<li><p>(Optional) Set a password</p></li>
<li><p>Choose allowed actions (e.g.&nbsp;select unlocked cells only)</p></li>
<li><p>Confirm</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>All cells are locked by default,<br>
but locking only takes effect after <strong>Protect Sheet</strong> is enabled.</p>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group exercise: Design a safe field data entry sheet (15min)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Work in pairs.</p>
<p>You are designing a spreadsheet for <strong>PSP tree inventory data</strong> collected in the field.</p>
<p>Your table must include at least the following variables:</p>
<ul>
<li><strong>PSP_id</strong> (unique identifier, e.g.&nbsp;metal tree tag)</li>
<li><strong>survey_date</strong> (date of measurement)</li>
<li><strong>species</strong> (scientific name)</li>
<li><strong>dbh_cm</strong> (diameter at breast height, in cm)</li>
<li><strong>height_m</strong> (tree height, in meters)</li>
<li><strong>quality_class</strong> (e.g.&nbsp;good / damaged / dead)</li>
</ul>
<section id="requirements" class="level4">
<h4 class="anchored" data-anchor-id="requirements">Requirements</h4>
<p>Design the spreadsheet so that it is <strong>hard to enter bad data</strong>:</p>
<ul>
<li>freeze the header row and identifier column</li>
<li>explicitly set data types for each column</li>
<li>use data validation:
<ul>
<li>numeric ranges for dbh and height</li>
<li>drop-down lists for quality_class and species names (you can just enter ABCâ€¦)</li>
</ul></li>
<li>prevent accidental re-sorting or overwriting</li>
</ul>
</section>
<section id="metadata" class="level4">
<h4 class="anchored" data-anchor-id="metadata">Metadata</h4>
<p>Decide: - what metadata belong in a <strong>separate sheet</strong> - what metadata must exist <strong>outside Excel</strong> (e.g.&nbsp;README)</p>
<p>ğŸ’¬ <strong>Be ready to explain</strong> - why each column has its format - what mistakes your design prevents - where Excel stops being sufficient</p>
</section>
</div>
</div>
</section>
<section id="additional-excel-knowledge-relevant-to-common-failures" class="level2">
<h2 class="anchored" data-anchor-id="additional-excel-knowledge-relevant-to-common-failures">Additional Excel knowledge relevant to common failures</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Excel gives <strong>no warning</strong> when approaching limits in CSV workflows.</p>
<p>Excel has no audit trail</p>
<ul>
<li>changes cannot be reconstructed</li>
<li>undo history is temporary</li>
<li>collaborators overwrite silently</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Limit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rows</td>
<td>1,048,576</td>
</tr>
<tr class="even">
<td>Columns</td>
<td>16,384</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reflection
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>What surprised you today?</li>
<li>What would you no longer trust Excel with?</li>
<li>What surprised you about how errors occur?</li>
<li>What would you like to know more about?</li>
</ul>
<p>If you can, please take some time and give feedback on todayâ€™s session: - <a href="https://docs.google.com/forms/d/e/1FAIpQLSeq-vXKigXOsmG4pytDaUjhykRoCPBbS-Ofy3marNTginVVTg/viewform?usp=dialog">Anonymous feedback</a></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>